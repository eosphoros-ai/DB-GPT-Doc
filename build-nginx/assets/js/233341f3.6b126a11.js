"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6656],{6053:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>c,toc:()=>h});var r=l(4848),t=l(8453),o=l(1470),s=l(9365);const a={},i="Flow",c={id:"api/flow",title:"Flow",description:"Get started with the App API",source:"@site/docs/api/flow.md",sourceDirName:"api",slug:"/api/flow",permalink:"/docs/latest/api/flow",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"App",permalink:"/docs/latest/api/app"},next:{title:"Knowledge",permalink:"/docs/latest/api/knowledge"}},d={},h=[{value:"Examples",id:"examples",level:3},{value:"Stream Chat Flow",id:"stream-chat-flow",level:3},{value:"Chat Completion Stream Response",id:"chat-completion-stream-response",level:4},{value:"Create Flow",id:"create-flow",level:3},{value:"Request body",id:"request-body",level:4},{value:"Response body",id:"response-body",level:4},{value:"Update Flow",id:"update-flow",level:3},{value:"Request body",id:"request-body-1",level:4},{value:"Response body",id:"response-body-1",level:4},{value:"Delete Flow",id:"delete-flow",level:3},{value:"Delete Parameters",id:"delete-parameters",level:4},{value:"Response body",id:"response-body-2",level:4},{value:"Get Flow",id:"get-flow",level:3},{value:"Query Parameters",id:"query-parameters",level:4},{value:"Response body",id:"response-body-3",level:4},{value:"List Flow",id:"list-flow",level:3},{value:"Response body",id:"response-body-4",level:4},{value:"The Flow Object",id:"the-flow-object",level:3}];function u(e){const n={code:"code",h1:"h1",h3:"h3",h4:"h4",hr:"hr",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"flow",children:"Flow"}),"\n",(0,r.jsx)(n.p,{children:"Get started with the App API"}),"\n",(0,r.jsx)(n.h1,{id:"chat-flow",children:"Chat Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"POST /api/v2/chat/completions\n"})}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n","\n","\n",(0,r.jsx)(n.h3,{id:"stream-chat-flow",children:"Stream Chat Flow"}),"\n",(0,r.jsxs)(o.A,{defaultValue:"python",groupId:"chat",values:[{label:"Curl",value:"curl"},{label:"Python",value:"python"}],children:[(0,r.jsx)(s.A,{value:"curl",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'DBGPT_API_KEY=dbgpt\nFLOW_ID={YOUR_FLOW_ID}\n\ncurl -X POST "http://localhost:5000/api/v2/chat/completions" \\\n    -H "Authorization: Bearer $DBGPT_API_KEY" \\\n    -H "accept: application/json" \\\n    -H "Content-Type: application/json" \\\n    -d "{\\"messages\\":\\"Hello\\",\\"model\\":\\"chatgpt_proxyllm\\", \\"chat_mode\\": \\"chat_flow\\", \\"chat_param\\": \\"$FLOW_ID\\"}"\n\n'})})}),(0,r.jsx)(s.A,{value:"python",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from dbgpt.client import Client\n\nDBGPT_API_KEY = "dbgpt"\nFLOW_ID="{YOUR_FLOW_ID}"\n\nclient = Client(api_key=DBGPT_API_KEY)\nasync for data in client.chat_stream(\n    messages="Introduce AWEL", \n    model="chatgpt_proxyllm", \n    chat_mode="chat_flow", \n    chat_param=FLOW_ID\n):\n    print(data)\n'})})})]}),"\n",(0,r.jsx)(n.h4,{id:"chat-completion-stream-response",children:"Chat Completion Stream Response"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-commandline",children:'data: {"id": "579f8862-fc4b-481e-af02-a127e6d036c8", "created": 1710918094, "model": "chatgpt_proxyllm", "choices": [{"index": 0, "delta": {"role": "assistant", "content": "\\n\\n"}}]}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"create-flow",children:"Create Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"POST /api/v2/serve/awel/flows\n"})}),"\n",(0,r.jsx)(n.h4,{id:"request-body",children:"Request body"}),"\n",(0,r.jsxs)(n.p,{children:["Request ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h4,{id:"response-body",children:"Response body"}),"\n",(0,r.jsxs)(n.p,{children:["Return ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h3,{id:"update-flow",children:"Update Flow"}),"\n",(0,r.jsx)(n.p,{children:"PUT /api/v2/serve/awel/flows"}),"\n",(0,r.jsx)(n.h4,{id:"request-body-1",children:"Request body"}),"\n",(0,r.jsxs)(n.p,{children:["Request ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h4,{id:"response-body-1",children:"Response body"}),"\n",(0,r.jsxs)(n.p,{children:["Return ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h3,{id:"delete-flow",children:"Delete Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"DELETE /api/v2/serve/awel/flows\n"})}),"\n",(0,r.jsxs)(o.A,{defaultValue:"curl_update_flow",groupId:"chat1",values:[{label:"Curl",value:"curl_update_flow"},{label:"Python",value:"python_update_flow"}],children:[(0,r.jsx)(s.A,{value:"curl_update_flow",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'DBGPT_API_KEY=dbgpt\nFLOW_ID={YOUR_FLOW_ID}\n \n curl -X DELETE "http://localhost:5000/api/v2/serve/awel/flows/$FLOW_ID" \\\n    -H "Authorization: Bearer $DBGPT_API_KEY" \\\n\n'})})}),(0,r.jsx)(s.A,{value:"python_update_flow",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from dbgpt.client import Client\nfrom dbgpt.client.flow import delete_flow\n\nDBGPT_API_KEY = "dbgpt"\nflow_id = "{your_flow_id}"\n\nclient = Client(api_key=DBGPT_API_KEY)\nres = await delete_flow(client=client, flow_id=flow_id)\n\n'})})})]}),"\n",(0,r.jsx)(n.h4,{id:"delete-parameters",children:"Delete Parameters"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"uid"}),"\n",(0,r.jsx)("font",{color:"gray",children:" string "}),"\n",(0,r.jsx)("font",{color:"red",children:" Required "}),"\n",(0,r.jsx)(n.p,{children:"flow id"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"response-body-2",children:"Response body"}),"\n",(0,r.jsxs)(n.p,{children:["Return ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h3,{id:"get-flow",children:"Get Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"GET /api/v2/serve/awel/flows/{flow_id}\n"})}),"\n",(0,r.jsxs)(o.A,{defaultValue:"curl_get_flow",groupId:"chat1",values:[{label:"Curl",value:"curl_get_flow"},{label:"Python",value:"python_get_flow"}],children:[(0,r.jsx)(s.A,{value:"curl_get_flow",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'DBGPT_API_KEY=dbgpt\nFLOW_ID={YOUR_FLOW_ID}\n\ncurl -X GET "http://localhost:5000/api/v2/serve/awel/flows/$FLOW_ID" -H "Authorization: Bearer $DBGPT_API_KEY"\n\n'})})}),(0,r.jsx)(s.A,{value:"python_get_flow",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from dbgpt.client import Client\nfrom dbgpt.client.knowledge import get_flow\n\nDBGPT_API_KEY = "dbgpt"\nflow_id = "{your_flow_id}"\n\nclient = Client(api_key=DBGPT_API_KEY)\nres = await get_flow(client=client, flow_id=flow_id)\n\n'})})})]}),"\n",(0,r.jsx)(n.h4,{id:"query-parameters",children:"Query Parameters"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"uid"}),"\n",(0,r.jsx)("font",{color:"gray",children:" string "}),"\n",(0,r.jsx)("font",{color:"red",children:" Required "}),"\n",(0,r.jsx)(n.p,{children:"flow id"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"response-body-3",children:"Response body"}),"\n",(0,r.jsxs)(n.p,{children:["Return ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h3,{id:"list-flow",children:"List Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"GET /api/v2/serve/awel/flows\n"})}),"\n",(0,r.jsxs)(o.A,{defaultValue:"curl_list_flow",groupId:"chat1",values:[{label:"Curl",value:"curl_list_flow"},{label:"Python",value:"python_list_flow"}],children:[(0,r.jsx)(s.A,{value:"curl_list_flow",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'DBGPT_API_KEY=dbgpt\n\ncurl -X GET "http://localhost:5000/api/v2/serve/awel/flows" -H "Authorization: Bearer $DBGPT_API_KEY"\n\n'})})}),(0,r.jsx)(s.A,{value:"python_list_flow",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'from dbgpt.client import Client\nfrom dbgpt.client.flow import list_flow\n\nDBGPT_API_KEY = "dbgpt"\n\nclient = Client(api_key=DBGPT_API_KEY)\nres = await list_flow(client=client)\n\n'})})})]}),"\n",(0,r.jsx)(n.h4,{id:"response-body-4",children:"Response body"}),"\n",(0,r.jsxs)(n.p,{children:["Return ",(0,r.jsx)("a",{href:"#the-flow-object",children:"Flow Object"})]}),"\n",(0,r.jsx)(n.h3,{id:"the-flow-object",children:"The Flow Object"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"uid"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The unique id for the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"name"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The name of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"description"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The description of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"label"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The label of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"flow_category"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The category of the flow. Default is FlowCategory.COMMON."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"flow_data"}),"\n",(0,r.jsx)("font",{color:"gray",children:"object"}),"\n",(0,r.jsx)(n.p,{children:"The flow data."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"state"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The state of the flow.Default is INITIALIZING."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"error_message"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The error message of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"source"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The source of the flow. Default is DBGPT-WEB."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"source_url"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The source url of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"version"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The version of the flow. Default is 0.1.0."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"editable"}),"\n",(0,r.jsx)("font",{color:"gray",children:"boolean"}),"\n",(0,r.jsx)(n.p,{children:"Whether the flow is editable. Default is True."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"user_name"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The user name of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"sys_code"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The system code of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"dag_id"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The dag id of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"gmt_created"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The created time of the flow."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)("b",{children:"gmt_modified"}),"\n",(0,r.jsx)("font",{color:"gray",children:"string"}),"\n",(0,r.jsx)(n.p,{children:"The modified time of the flow."}),"\n",(0,r.jsx)(n.hr,{})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},9365:(e,n,l)=>{l.d(n,{A:()=>s});l(6540);var r=l(53);const t={tabItem:"tabItem_Ymn6"};var o=l(4848);function s(e){let{children:n,hidden:l,className:s}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,s),hidden:l,children:n})}},1470:(e,n,l)=>{l.d(n,{A:()=>v});var r=l(6540),t=l(53),o=l(3104),s=l(6347),a=l(205),i=l(7485),c=l(1682),d=l(9466);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:l}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:l,attributes:r,default:t}}=e;return{value:n,label:l,attributes:r,default:t}}))}(l);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,l])}function p(e){let{value:n,tabValues:l}=e;return l.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:l}=e;const t=(0,s.W6)(),o=function(e){let{queryString:n=!1,groupId:l}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!l)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return l??null}({queryString:n,groupId:l});return[(0,i.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(t.location.search);n.set(o,e),t.replace({...t.location,search:n.toString()})}),[o,t])]}function j(e){const{defaultValue:n,queryString:l=!1,groupId:t}=e,o=u(e),[s,i]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:l}=e;if(0===l.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:l}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${l.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=l.find((e=>e.default))??l[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:o}))),[c,h]=f({queryString:l,groupId:t}),[j,x]=function(e){let{groupId:n}=e;const l=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,o]=(0,d.Dv)(l);return[t,(0,r.useCallback)((e=>{l&&o.set(e)}),[l,o])]}({groupId:t}),b=(()=>{const e=c??j;return p({value:e,tabValues:o})?e:null})();(0,a.A)((()=>{b&&i(b)}),[b]);return{selectedValue:s,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),h(e),x(e)}),[h,x,o]),tabValues:o}}var x=l(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var w=l(4848);function m(e){let{className:n,block:l,selectedValue:r,selectValue:s,tabValues:a}=e;const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),d=e=>{const n=e.currentTarget,l=i.indexOf(n),t=a[l].value;t!==r&&(c(n),s(t))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const l=i.indexOf(e.currentTarget)+1;n=i[l]??i[0];break}case"ArrowLeft":{const l=i.indexOf(e.currentTarget)-1;n=i[l]??i[i.length-1];break}}n?.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":l},n),children:a.map((e=>{let{value:n,label:l,attributes:o}=e;return(0,w.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>i.push(e),onKeyDown:h,onClick:d,...o,className:(0,t.A)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":r===n}),children:l??n},n)}))})}function g(e){let{lazy:n,children:l,selectedValue:t}=e;const o=(Array.isArray(l)?l:[l]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function _(e){const n=j(e);return(0,w.jsxs)("div",{className:(0,t.A)("tabs-container",b.tabList),children:[(0,w.jsx)(m,{...e,...n}),(0,w.jsx)(g,{...e,...n})]})}function v(e){const n=(0,x.A)();return(0,w.jsx)(_,{...e,children:h(e.children)},String(n))}},8453:(e,n,l)=>{l.d(n,{R:()=>s,x:()=>a});var r=l(6540);const t={},o=r.createContext(t);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);