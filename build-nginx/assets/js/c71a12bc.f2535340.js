"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7319],{9220:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>c,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var r=n(4848),o=n(8453);const s={},a="3.3 Handling Post Requests",l={id:"awel/awel_tutorial/network_program/3.3_http_trigger_post",title:"3.3 Handling Post Requests",description:"The HttpTrigger operator can also handle POST requests. In this section, we will",source:"@site/docs/awel/awel_tutorial/network_program/3.3_http_trigger_post.md",sourceDirName:"awel/awel_tutorial/network_program",slug:"/awel/awel_tutorial/network_program/3.3_http_trigger_post",permalink:"/docs/latest/awel/awel_tutorial/network_program/3.3_http_trigger_post",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"3.2 Handling GET Requests",permalink:"/docs/latest/awel/awel_tutorial/network_program/3.2_http_trigger_get"},next:{title:"3.4 Handling Streaming Requests",permalink:"/docs/latest/awel/awel_tutorial/network_program/3.4_http_trigger_streaming"}},i={},d=[{value:"Say Hello To Someone",id:"say-hello-to-someone",level:2}];function p(e){const t={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"33-handling-post-requests",children:"3.3 Handling Post Requests"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"HttpTrigger"})," operator can also handle POST requests. In this section, we will\ncreate a new HTTP trigger that returns a json response based on the request body of the POST request."]}),"\n",(0,r.jsx)(t.h2,{id:"say-hello-to-someone",children:"Say Hello To Someone"}),"\n",(0,r.jsxs)(t.p,{children:["Create a new file named ",(0,r.jsx)(t.code,{children:"http_trigger_say_hello_post.py"})," in the ",(0,r.jsx)(t.code,{children:"awel_tutorial"})," directory and add the following code:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-python",children:'from dbgpt._private.pydantic import BaseModel, Field\nfrom dbgpt.core.awel import DAG, HttpTrigger, MapOperator, setup_dev_environment\n\nclass TriggerReqBody(BaseModel):\n    name: str = Field(..., description="User name")\n    age: int = Field(18, description="User age")\n\nwith DAG("awel_say_hello_post") as dag:\n    trigger_task = HttpTrigger(\n        endpoint="/awel_tutorial/say_hello_post", \n        methods="POST", \n        request_body=TriggerReqBody,\n        status_code=200\n    )\n    task = MapOperator(\n        map_function=lambda x: {"message": f"Hello, {x.name}! You are {x.age} years old."}\n    )\n    trigger_task >> task\n\nsetup_dev_environment([dag], port=5555)\n'})}),"\n",(0,r.jsx)(t.p,{children:"And run the following command to execute the code:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"poetry run python awel_tutorial/http_trigger_say_hello_post.py\n"})}),"\n",(0,r.jsx)(t.p,{children:"Now, open a new terminal and run the following command to send a POST request to the server:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:'curl -X POST \\\n"http://127.0.0.1:5555/api/v1/awel/trigger/awel_tutorial/say_hello_post" \\\n-H "Content-Type: application/json" \\\n-d \'{"name": "John", "age": 25}\'\n'})}),"\n",(0,r.jsx)(t.p,{children:"The output should look like this:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-plaintext",children:'{"message":"Hello, John! You are 20 years old."}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Then you can stop the server by pressing ",(0,r.jsx)(t.code,{children:"Ctrl+C"}),"."]})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>l});var r=n(6540);const o={},s=r.createContext(o);function a(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);