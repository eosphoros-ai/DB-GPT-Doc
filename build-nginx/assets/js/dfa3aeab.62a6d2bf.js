"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1410],{7198:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>o,contentTitle:()=>s,default:()=>l,frontMatter:()=>d,metadata:()=>i,toc:()=>c});var n=t(4848),r=t(8453);const d={},s="Upgrade To v0.5.0",i={id:"upgrade/v0.5.0",title:"Upgrade To v0.5.0",description:"Overview",source:"@site/versioned_docs/version-v0.5.1/upgrade/v0.5.0.md",sourceDirName:"upgrade",slug:"/upgrade/v0.5.0",permalink:"/docs/v0.5.1/upgrade/v0.5.0",draft:!1,unlisted:!1,tags:[],version:"v0.5.1",frontMatter:{},sidebar:"docs",previous:{title:"Released V0.5.0 | Develop native data applications through workflows and agents",permalink:"/docs/v0.5.1/changelog/Released_V0.5.0"},next:{title:"Upgrade To v0.5.1",permalink:"/docs/v0.5.1/upgrade/v0.5.1"}},o={},c=[{value:"Overview",id:"overview",level:2},{value:"Prepare",id:"prepare",level:2},{value:"Backup Your Database",id:"backup-your-database",level:3},{value:"Upgrade",id:"upgrade",level:2},{value:"Stop DB-GPT Service",id:"stop-db-gpt-service",level:3},{value:"Upgrade Database",id:"upgrade-database",level:3},{value:"Install Dependencies",id:"install-dependencies",level:3},{value:"Start DB-GPT Service",id:"start-db-gpt-service",level:3}];function p(e){const a={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h1,{id:"upgrade-to-v050",children:"Upgrade To v0.5.0"}),"\n",(0,n.jsx)(a.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsx)(a.p,{children:"This guide is for upgrading from v0.4.6 and v0.4.7 to v0.5.0. If you use SQLite,\nyou not need to upgrade the database. If you use MySQL, you need to upgrade the database."}),"\n",(0,n.jsx)(a.h2,{id:"prepare",children:"Prepare"}),"\n",(0,n.jsx)(a.h3,{id:"backup-your-database",children:"Backup Your Database"}),"\n",(0,n.jsx)(a.p,{children:"To prevent data loss, it is recommended to back up your database before upgrading.\nThe backup way according to your database type."}),"\n",(0,n.jsx)(a.h2,{id:"upgrade",children:"Upgrade"}),"\n",(0,n.jsx)(a.h3,{id:"stop-db-gpt-service",children:"Stop DB-GPT Service"}),"\n",(0,n.jsx)(a.p,{children:"Stop the DB-GPT service according to your start way."}),"\n",(0,n.jsx)(a.h3,{id:"upgrade-database",children:"Upgrade Database"}),"\n",(0,n.jsx)(a.p,{children:"Execute the following SQL to upgrade the database."}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"New Tables"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-sql",children:"-- dbgpt.dbgpt_serve_flow definition\nCREATE TABLE `dbgpt_serve_flow` (\n  `id` int NOT NULL AUTO_INCREMENT COMMENT 'Auto increment id',\n  `uid` varchar(128) NOT NULL COMMENT 'Unique id',\n  `dag_id` varchar(128) DEFAULT NULL COMMENT 'DAG id',\n  `name` varchar(128) DEFAULT NULL COMMENT 'Flow name',\n  `flow_data` text COMMENT 'Flow data, JSON format',\n  `user_name` varchar(128) DEFAULT NULL COMMENT 'User name',\n  `sys_code` varchar(128) DEFAULT NULL COMMENT 'System code',\n  `gmt_created` datetime DEFAULT NULL COMMENT 'Record creation time',\n  `gmt_modified` datetime DEFAULT NULL COMMENT 'Record update time',\n  `flow_category` varchar(64) DEFAULT NULL COMMENT 'Flow category',\n  `description` varchar(512) DEFAULT NULL COMMENT 'Flow description',\n  `state` varchar(32) DEFAULT NULL COMMENT 'Flow state',\n  `source` varchar(64) DEFAULT NULL COMMENT 'Flow source',\n  `source_url` varchar(512) DEFAULT NULL COMMENT 'Flow source url',\n  `version` varchar(32) DEFAULT NULL COMMENT 'Flow version',\n  `label` varchar(128) DEFAULT NULL COMMENT 'Flow label',\n  `editable` int DEFAULT NULL COMMENT 'Editable, 0: editable, 1: not editable',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_uid` (`uid`),\n  KEY `ix_dbgpt_serve_flow_sys_code` (`sys_code`),\n  KEY `ix_dbgpt_serve_flow_uid` (`uid`),\n  KEY `ix_dbgpt_serve_flow_dag_id` (`dag_id`),\n  KEY `ix_dbgpt_serve_flow_user_name` (`user_name`),\n  KEY `ix_dbgpt_serve_flow_name` (`name`)\n) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;\n\n-- dbgpt.gpts_app definition\nCREATE TABLE `gpts_app` (\n  `id` int NOT NULL AUTO_INCREMENT COMMENT 'autoincrement id',\n  `app_code` varchar(255) NOT NULL COMMENT 'Current AI assistant code',\n  `app_name` varchar(255) NOT NULL COMMENT 'Current AI assistant name',\n  `app_describe` varchar(2255) NOT NULL COMMENT 'Current AI assistant describe',\n  `language` varchar(100) NOT NULL COMMENT 'gpts language',\n  `team_mode` varchar(255) NOT NULL COMMENT 'Team work mode',\n  `team_context` text COMMENT 'The execution logic and team member content that teams with different working modes rely on',\n  `user_code` varchar(255) DEFAULT NULL COMMENT 'user code',\n  `sys_code` varchar(255) DEFAULT NULL COMMENT 'system app code',\n  `created_at` datetime DEFAULT NULL COMMENT 'create time',\n  `updated_at` datetime DEFAULT NULL COMMENT 'last update time',\n  `icon` varchar(1024) DEFAULT NULL COMMENT 'app icon, url',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_gpts_app` (`app_name`)\n) ENGINE=InnoDB AUTO_INCREMENT=39 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;\n\nCREATE TABLE `gpts_app_collection` (\n  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'autoincrement id',\n  `app_code` varchar(255) NOT NULL COMMENT 'Current AI assistant code',\n  `user_code` int(11) NOT NULL COMMENT 'user code',\n  `sys_code` varchar(255) NOT NULL COMMENT 'system app code',\n  `created_at` datetime DEFAULT NULL COMMENT 'create time',\n  `updated_at` datetime DEFAULT NULL COMMENT 'last update time',\n  PRIMARY KEY (`id`),\n  KEY `idx_app_code` (`app_code`),\n  KEY `idx_user_code` (`user_code`)\n) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4 COMMENT=\"gpt collections\";\n\n-- dbgpt.gpts_app_detail definition\nCREATE TABLE `gpts_app_detail` (\n  `id` int NOT NULL AUTO_INCREMENT COMMENT 'autoincrement id',\n  `app_code` varchar(255) NOT NULL COMMENT 'Current AI assistant code',\n  `app_name` varchar(255) NOT NULL COMMENT 'Current AI assistant name',\n  `agent_name` varchar(255) NOT NULL COMMENT ' Agent name',\n  `node_id` varchar(255) NOT NULL COMMENT 'Current AI assistant Agent Node id',\n  `resources` text COMMENT 'Agent bind  resource',\n  `prompt_template` text COMMENT 'Agent bind  template',\n  `llm_strategy` varchar(25) DEFAULT NULL COMMENT 'Agent use llm strategy',\n  `llm_strategy_value` text COMMENT 'Agent use llm strategy value',\n  `created_at` datetime DEFAULT NULL COMMENT 'create time',\n  `updated_at` datetime DEFAULT NULL COMMENT 'last update time',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `uk_gpts_app_agent_node` (`app_name`,`agent_name`,`node_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=23 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;\n\n\n"})}),"\n",(0,n.jsx)(a.p,{children:(0,n.jsx)(a.strong,{children:"Add Columns"})}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-sql",children:"ALTER TABLE `gpts_conversations`\nADD COLUMN `team_mode` varchar(255) NULL COMMENT 'agent team work mode';\n\nALTER TABLE `gpts_conversations`\nADD COLUMN  `current_goal` text COMMENT 'The target corresponding to the current message';\n"})}),"\n",(0,n.jsx)(a.h3,{id:"install-dependencies",children:"Install Dependencies"}),"\n",(0,n.jsx)(a.p,{children:"Install dependencies according to your installation way, if your installation from\nsource code and use the default way, you can run the following command:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:'pip install -e ".[default]"\n'})}),"\n",(0,n.jsx)(a.h3,{id:"start-db-gpt-service",children:"Start DB-GPT Service"}),"\n",(0,n.jsx)(a.p,{children:"Start your DB-GPT service according to your start way."})]})}function l(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},8453:(e,a,t)=>{t.d(a,{R:()=>s,x:()=>i});var n=t(6540);const r={},d=n.createContext(r);function s(e){const a=n.useContext(d);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(d.Provider,{value:a},e.children)}}}]);